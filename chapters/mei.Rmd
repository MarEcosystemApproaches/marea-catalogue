# Multivariate ENSO Index

**Description**: Comprehensive characterization of an El Nino Oscillation event; standardized anomaly value.

**Data Type**: Tabular data

**Spatial Scope**: Coastwide

**Temporal Breadth**: 1979 - 2025

**Contact(s)**: Name of data contributor including email. 

**Source**: [NOAA Earth System Research Laboratories and Physical Science Laboratory](https://psl.noaa.gov/enso/mei/)

```{r echo=FALSE, message=F}
knitr::opts_chunk$set(echo = F)
library(marea)
```


## Introduction to Indicator
Paragraph(s) on indicator history and values.


## Trends
Basic figures summarizing trends in indicator data

```{r}
# Plots of data trends for indicator
data("mei")
mei@data %>%
    mutate(date = lubridate::make_date(year, month, day = 1))  %>%
  ggplot(aes(x = date,
             y = anomaly_value)) + 
  geom_line(linewidth = .7) +
  theme_bw() +
  labs(x = "Date",
       y = "Multivariate ENSO Index (Version 2)\nStandardized anomaly",
       title = "Multivariate ENSO Index (Version 2) for Equatorial Pacific")
```


```{r, warning=F, message=F}
library(plotly)
data <- mei@data %>%
    mutate(date = lubridate::make_date(year, month, day = 1),
           smooth_1yr = zoo::rollmean(anomaly_value, k = 12, fill = NA, align = "center"),
        smooth_3yr = zoo::rollmean(anomaly_value, k = 36, fill = NA, align = "center"))

p <- plot_ly(data, x = ~date) %>%
  add_lines(y = ~anomaly_value,
            name = "Monthly Anomaly",
            line = list(color = "lightgrey"),
            hoverinfo = "x+text",
            text = ~paste0("MEI: ", anomaly_value," °C")) %>%
  add_lines(y = ~smooth_1yr,
            name = "1-yr Smooth",
            line = list(color = "blue", width = 2),
            hoverinfo = "x+text",
            text = ~paste0("1-yr smoothed: ", round(smooth_1yr, 2), "°C")) %>%
  add_lines(y = ~smooth_3yr,
            name = "3-yr Smooth",
            line = list(color = "red", width = 2),
            hoverinfo = "x+text",
            text = ~paste0("3-yr smoothed: ", round(smooth_3yr, 2)," °C")) %>%
  layout(
    title = "Multivariate ENSO Index",
    xaxis = list(title = "Date"),
    yaxis = list(title = "MEI v2"),
    hovermode = "x unified"
  ) %>%
  config(displayModeBar = FALSE)


p


p2 <- plot_ly(data, x = ~date) %>%
  add_bars(y = ~anomaly_value,
          color = ~anomaly_value > 0, colors = c("blue", "red"),
          opacity = .5,
          text = ~paste0("Anomaly: ",anomaly_value),
          hoverinfo = "x+text") %>%
  add_lines(y = ~smooth_1yr,
            name = "1-yr Smooth",
            line = list(color = "black", width = 2),
            hoverinfo = "x+text",
            text = ~paste0("1-yr smoothed: ", round(smooth_1yr, 2), "°C"))  %>%
  
  add_lines(y = ~smooth_3yr,
            name = "3-yr Smooth",
            line = list(color = "black", width = 2, dash = "dash"),
            hoverinfo = "x+text",
            text = ~paste0("3-yr smoothed: ", round(smooth_3yr, 2), "°C"))  %>%
  layout(
    title = "Multivariate ENSO Index",
    xaxis = list(title = "Date"),
    yaxis = list(title = "MEI v2"),
    hovermode = "x unified"
  ) %>%
  config(displayModeBar = FALSE)
p2

```

## Relevance to Research and Stock Assessments
Proceed as though this were a short summary of a typical discussion section in a paper.


## Get the data
code to access data from marea R package

```{r, include=T, echo=T, eval=F}
library(marea)
data("mei")
plot(mei)
```


## Variable Definitions
```{r}
varDefs <- tibble::tribble(
  ~variable, ~definition, ~unit,
  "year",     "year of anomaly value", "",
  "month",    "month of anomaly value", "",
  "anomaly_value", "multivariate index of ENSO strength, standardized anomaly", ""
)

knitr::kable(varDefs)

```
